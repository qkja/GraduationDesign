
%% ---------------------------------------------
\section{Introduction}


%% ---------------------------------------------

\section{Probelm description}
In this study, the lattice Boltzmann method was employed to investigate the heat and mass transfer mechanisms during the phase change process in a square cavity with a length-to-width ratio of 1:1, filled with paraffin as the phase change material (PCM). The thermal input on the upper/left/bottom walls of the cavity is sinusoidal, while the remaining walls are adiabatic and have a no-slip condition. The relationship between the sinusoidal heat flux and the wall positions is as follows: 

\begin{equation}\label{PD.q-up}
q_{\text {in }}=q\left(1+A \sin \left(2 \pi \cdot x_{i} \cdot T / l\right)\right.
\end{equation}

Where $T$ represents the period, and $A$ represents the amplitude. When the up/bottom walls of the cavity are heated, the variable $x_{i}$ represents the horizontal coordinate position. Conversely, when the left wall of the cavity is heated, $x_{i}$ represents the vertical coordinate position. The study investigates the influence of these variables on heat and mass transfer during the phase change process by varying the period,amplitude and Rayleigh number while keeping the heating on the same wall constant.
%%-----------------------------------------------------%%

\section{Control equations}


The fluid in this paper(liquid phase PCM),is hypothesized to be Newtonian incompressible laminar flow,the control equations for mass,momentum and energy transport of PCM are described as follows:

\begin{equation}\label{CE.rho}
	\frac{\partial \rho}{\partial t}+\nabla \cdot(\rho \boldsymbol{u})=0 
\end{equation}

\begin{equation}\label{CE.u}
	\frac{\partial(\rho \boldsymbol{u})}{\partial t}+\frac{\partial(\rho \boldsymbol{u} \boldsymbol{u})}{\partial x}=-\nabla p+\nabla \cdot(\mu \nabla \boldsymbol{u})+\boldsymbol{F}
\end{equation}

\begin{equation}\label{CE.C}
	\frac{\partial\left(\rho C_{\mathrm{p}} T\right)}{\partial t}+\nabla \cdot\left(\rho C_{\mathrm{p}} T \boldsymbol{u}\right)=\nabla \cdot(k \nabla T)+q
\end{equation}

where,$\rho$,$\mu$, $k$, $C_p$ are the density, the dynamic viscosity of PCM, thermal conductivity and specific heat at constant pressure, respectively. $p$ is the pressure, ,$\boldsymbol{u}$, $T$, are the velocity, and tempreature. 
 The force term,$\boldsymbol{F}$, in the third term on the right-hand side of Eq \ref{CE.u},calculated by:

\begin{equation}\label{F}
\boldsymbol{F}=\rho \mathbf{g} \beta\left(T-T_{\mathrm{ref}}\right)
\end{equation}

where, $g$ is the gravitational acceleration,  $\beta$ is the coefficient of thermal expansion, $T_{\mathrm{ref}}$ is the reference temperature and $q$ on the right hand of Eq \ref{CE.C}, is the heat sorce term,given as:

\begin{equation}\label{q}
q=-\frac{\partial}{\partial t}(\rho \Delta H)-\nabla \cdot(\rho \mathbf{u} \Delta H)
\end{equation}

where, $\Delta H$ is the latent enthalpy.Assuming that the phase change rate, denoted as $\psi$, is driven by the temperature gradient, for the pure PCM, heat source term $q$ can be simplified as:

\begin{equation}\label {deta H}
q=-\frac{\partial\left(\rho h_{s l} \psi\right)}{\partial t}
\end{equation}

The enthalpy  $H$  in the energy equation is determined by the combined contribution of sensible and latent enthalpy:

\begin{equation}\label{H}
H=C_{p} T+\psi h_{s l}
\end{equation}

Substituting $H$ and $q$ into Eq \ref{CE.C}, the simplified energy conservation equation is as follows:

\begin{equation}\label {CE.C1}
\frac{\partial(\rho H)}{\partial t}+\nabla \cdot\left(\rho C_{\mathrm{p}} \mathrm{T} \boldsymbol{u}\right)=\nabla \cdot(k \nabla T)
\end{equation}
	
%%-----------------------------------------------------%%

\section{Lattice Boltzmann model}
This paper adopts a multi-distribution lattice Boltzmann model to simulate the heat and mass transfer problem of phase change materials.   The evolution equation for the density distribution with the BGK collision term is given as follows:

\begin{equation}\label {LBM.BGK}
f_{i}\left(x+\boldsymbol{e}_{i} \Delta t, t+\Delta t\right)=f_{i}(x, t)-\frac{1}{\tau_{f}}\left[f_{i}(x, t)-f_{i}^{e q}(x, t)\right]+\Delta t F_{i}
	\end{equation}\label {LBM.BGK}
		
\begin{equation}\label {LBM.gi}		
		g_{i}\left(x+e_{i} \Delta t, t+\Delta t\right)=g_{i}(x, t)-\frac{1}{\tau_{g}}\left[g_{i}(x, t)-g_{i}^{e q}(x, t)\right] 
	\end{equation}\label {LBM.gi}

where the superscript $"i"$ represent the direction, $e_{i}$ is the  discrete velocity, $\tau_{f}$ is the dimensionless relaxtion time.$f_{i}$ and $g_{i}$ are the distribution functions for density and enthalpy and the equilibrium functions are obtained from:

\begin{equation}\label {LBM.fi-eq}
f_{i}^{e q}=\omega_{i} \rho\left[1+\frac{\boldsymbol{e}_{i} \cdot \boldsymbol{u}}{c_{s}^{2}}+\frac{\left(\boldsymbol{e}_{i} \cdot \boldsymbol{u}\right)}{2 c_{s}^{4}}-\frac{u^{2}}{2 c_{s}^{2}}\right]
\end{equation}\label {LBM.fi-eq}

\begin{equation}\label {LBM.gi-eq}
	f_{i}^{e q}=\omega_{i} \rho\left[1+\frac{\boldsymbol{e}_{i} \cdot \boldsymbol{u}}{c_{s}^{2}}+\frac{\left(\boldsymbol{e}_{i} \cdot \boldsymbol{u}\right)}{2 c_{s}^{4}}-\frac{u^{2}}{2 c_{s}^{2}}\right]
\end{equation}\label {LBM.gi-eq}

where $omega_{i}$ is the weight coefficient,in D2Q9 model, which can be obtained as:

\begin{equation}\label {LBM.omega-i}
\omega_{i}=\left\{\begin{array}{ll}
	\frac{4}{9} & i=0 \\
	\frac{1}{9} & i=1,2,3,4 \\
	\frac{1}{36} & i=5,6,7,8
\end{array}\right.
\end{equation}\label {LBM.omega-i}

Besdies, $e_{i}$ in this model is given by:

\begin{equation}\label {LBM.e-i}
e_{i}=\left\{\begin{array}{ll}
	(0,0) & i=0 \\
	c\left(\cos \left[\frac{\pi}{2}(i-1)\right], \sin \left[\frac{\pi}{2}(i-1)\right]\right) & i=1,2,3,4 \\
	\sqrt{2} c\left(\cos \left[\frac{\pi}{4}(2 i-1)\right], \sin \left[\frac{\pi}{4}(2 i-1)\right]\right) & i=5,6,7,8
\end{array}\right.
\end{equation}\label {LBM.e-i}

where $c$ is the lattice speed, can be computed by:

\begin{equation}\label {LBM.c}
c=(\Delta x / \Delta t)
\end{equation}\label {LBM.c}

\begin{equation}\label {LBM.cs}
c^{2}=1 / 3 c_{s}^{2}
\end{equation}\label {LBM.cs}

These macroscopic physical quantities:density, velocity, enthalpy  can be calculated by the following:

\begin{equation}\label {LBM.rho}
\rho=\sum_{0}^{8} f_{i}
\end{equation}\label {LBM.rho}

\begin{equation}\label {LBM.rho-u}
\rho \boldsymbol{u}=\sum_{0}^{8} \boldsymbol{e}_{i} f_{i}+\frac{\Delta t}{2} \boldsymbol{F}
\end{equation}\label {LBM.rho-u}

\begin{equation}\label {LBM.H}
	H=\sum_{0}^{8} g_{i}
\end{equation}\label {LBM.H}

Applying the Boussinesq assumption, the discrete body force term $F_{i}$ in Eq \ref{LBM.BGK} can be caculated by :

\begin{equation}\label {LBM.Fi}
F_{i} & =\omega_{i}\left(1-\frac{1}{2 \tau_{f}}\right)\left(\frac{\boldsymbol{e}_{i}-\boldsymbol{u}}{c_{s}^{2}}+\frac{\boldsymbol{e}_{i} \cdot \boldsymbol{u}}{c_{s}^{4}} \boldsymbol{e}_{i}\right) \cdot \boldsymbol{F} \\
& =\omega_{i}\left(1-\frac{1}{2 \tau_{f}}\right)\left(\frac{\boldsymbol{e}_{i}-\boldsymbol{u}}{c_{s}^{2}}+\frac{\boldsymbol{e}_{i} \cdot \boldsymbol{u}}{c_{s}^{4}} \boldsymbol{e}_{i}\right) \cdot \rho \mathbf{g} \beta\left(T-T_{\text {ref }}\right)
\end{equation}\label {LBM.Fi}

Furthermore, the relaxtion time $\tau_{f}$ and $\tau_{g}$ and dimensionless temperatures $T$ are defined as:

\begin{equation}\label {LBM.\tau_{f}}
\tau_{f}=\frac{\mu}{\rho c_{s}^{2} \Delta t}+0.5=\frac{v}{c_{s}^{2} \Delta t}+0.5
\end{equation}\label {LBM.\tau_{f}}

\begin{equation}\label {LBM.\tau_{g}}
	\tau_{g}=\frac{k}{\rho C_{\mathrm{p}} c_{s}^{2} \Delta t}+0.5=\frac{\alpha}{c_{s}^{2} \Delta t}+0.5
\end{equation}\label {LBM.\tau_{g}}
 	
 \begin{equation}\label {LBM.T}
 		T=\left\{\begin{array}{ll}
 			\frac{H}{C_{\mathrm{p}}} & T<T_{s} \\
 			T_{s}+\frac{H-H_{s}}{H_{l}-H_{s}}\left(T_{l}-T_{s}\right) & T_{s} \leqslant T \leqslant T_{l} \\
 			T_{l}+\frac{\left(H-H_{l}\right)}{C_{\mathrm{p}}} & T \geqslant T_{l}
 		\end{array}\right.
 	\end{equation}\label {LBM.T}
 
Where $\mathcal{V}$ and $frac{\alpha}$ represent kinetic viscosity and thermal diffusivity,respectively.The superscript $l$ and $s$ demonstrates the liquid phase and solid phase of PCM.
%% ---------------------------------------------

\section{LBM boundary conditions}
Improvement in the unbalanced extrapolation scheme, proposed by Guo et al., exhibits enhanced applicability by decomposing the distribution function on the boundary nodes into two components: equilibrium and non-equilibrium states, as shown below:

\begin{equation}\label {LBM.Gamma}
\Gamma=\Gamma^{e q}+\Gamma^{n e q}
\end{equation}\label {LBM.Gamma}

Where,the equilibrium state component $\Gamma^{e q}$ is computed based on the equilibrium distribution function of macroscopic physical quantities defined on the boundaries, according to equations x and xx. The non-equilibrium state component $\Gamma^{n e q}$ can be obtained from neighboring nodes:

\begin{equation}\label {LBM.Gamma-neq}
\Gamma_{x_{b}}^{n e q}=\Gamma_{x_{c}}-\Gamma_{x_{c}}^{e q}
\end{equation}\label {LBM.Gamma-neq}

Eq \ref{LBM.BGK} is only applicable under the flow conditions of liquid-phase change materials (PCMs).  However, during the melting process of PCMs at the solid-liquid phase change interface, the fluid nodes are influenced by the solid-liquid phase change interface.  Huang et al. extended the immersed boundary conditions proposed by Noble and Torczynski to solid-liquid phase change.  The modified governing equation for the flow field is as follows:

\begin{equation}\label {LBM.modified}
f_{i}\left(x+e_{i} \Delta t, t+\Delta t\right)=f_{i}(x, t)-\frac{1-B}{\tau_{f}}\left[f_{i}(x, t)-f_{i}^{e q}(x, t)\right]+B \Omega_{i}^{s}+\Delta t F_{i}
\end{equation}\label {LBM.modified}

Where $B$ is the weighting function whose value is determined by the liquid-phase fraction of the nodesï¼š

\begin{equation}\label {LBM.B}
B=\frac{\left(1-f_{l}\right)\left(\tau_{f}-0.5\right)}{f_{l}+\tau_{f}-0.5}
\end{equation}\label {LBM.B}


$\Omega_{i}^{s}$ is the improved additional collision term proposed by Holdych in his doctoral thesis and is given by:

\begin{equation}\label {LBM.\Omega_{i}^{s}}
\Omega_{i}^{s}=f_{i}(x, t)-f_{i}(x, t)+f_{i}^{e q}\left(\rho, \boldsymbol{u}_{s}\right)-f_{i}^{e q}\left(\rho, \boldsymbol{u}_{s}\right)
\end{equation}\label {LBM.\Omega_{i}^{s}}

\section{Model validation}



%%-----------------------------------------------------%%